<button
  id="theme-toggle"
  type="button"
  class="md:ml-1 inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-500"
  aria-label="Toggle dark mode"
>
  <span id="theme-toggle-dark-icon" class="hidden md:w-5 md:h-5 w-6 h-6 icon-[material-symbols--dark-mode]"></span>
  <span id="theme-toggle-light-icon" class="hidden md:w-5 md:h-5 w-6 h-6 icon-[material-symbols--light-mode]"></span>
</button>
<script>
  import { useTheme } from '../../composables/useTheme';
  const { toggleTheme,  getTheme } = useTheme();
  function updateIcons(theme: import('../../composables/useTheme').Theme) {
    const darkIcon = document.getElementById('theme-toggle-dark-icon');
    const lightIcon = document.getElementById('theme-toggle-light-icon');
    if (!darkIcon || !lightIcon) return;
    if (theme === 'dark') {
      lightIcon.classList.remove('hidden');
      darkIcon.classList.add('hidden');
    } else {
      darkIcon.classList.remove('hidden');
      lightIcon.classList.add('hidden');
    }
  }

  function init() {
    updateIcons(getTheme());
    const btn = document.getElementById('theme-toggle');
    if (!btn) return;
    btn.addEventListener('click', () => {
      const t = toggleTheme();
      updateIcons(t);
    });
  }

  if ('requestIdleCallback' in window) {
    requestIdleCallback(init);
  } else {
    setTimeout(init, 0);
  }
</script>
